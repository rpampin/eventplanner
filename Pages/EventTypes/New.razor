@page "/event-type"
@using EventPlanner.Models
@using EventPlanner.Data
@inject EventTypeService eventTypeService
@inject NavigationManager NavigationManager
@inject AppState AppState
<Loading IsLoading="AppState.IsLoading" />

<div class="title-action">
    <MudText Typo="Typo.h2">New Event Type</MudText>
    <MudButton Variant="Variant.Text" StartIcon="@Icons.Filled.Close" Color="Color.Transparent" OnClick="Cancel"> Cancel</MudButton>
</div>

<EditForm Model="@obj" OnValidSubmit="Insert">
    <DataAnnotationsValidator />
    <MudCard>
        <MudCardContent>
            <MudTextField Label="Name" Variant="Variant.Outlined" @bind-Value="obj.Name" For="@(() => obj.Name)" />
        </MudCardContent>
        <MudCardActions>
            <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Success" StartIcon="@Icons.Filled.Save" Class="ml-auto">Save</MudButton>
        </MudCardActions>
    </MudCard>
</EditForm>

@code {
    EventType obj = new EventType();

    async Task Insert()
    {
        await AppState.RunAsync(async () =>
        {
            await eventTypeService.InsertOne(obj);
            NavigationManager.NavigateTo("event-types");
        });

    }

    void Cancel()
        => NavigationManager.NavigateTo("event-types", true);
}
